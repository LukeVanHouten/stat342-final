source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
shiny::runApp('C:/Users/lukev/INFO/final-projects-nutrition-obesity-legis')
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(data)
ggplot(data = as.data.frame(data)) +
geom_boxplot(aes(x = COVID, y = No_COVID))
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(data)
data <- as.matrix(read.csv("data.csv"))
mosaic(data, gp = gpar(fill = c("lightblue", "pink", "red", "blue")),
labeling = labeling_values,
labeling_args = list(
set_varnames = c(Covid = "COVID", No_Covid = "No COVID"),
set_labels = list(Covid = rownames(data))))
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
as.matrix(select(data, -Test))
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(data)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(data)
as.matrix(data)[1]
as.matrix(data)[[1]]
colnames(as.matrix(data))
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
as.matrix(data[, -1])
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(reshape2::melt(data, id.vars = "Test", variable.name = "Condition", value.name = "Count"))
install.packages("reshape2")
View(reshape2::melt(data, id.vars = "Test", variable.name = "Condition", value.name = "Count"))
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
(8 / (8 + 17411)) / ((8 / (8 + 17411)) + (162 / (162 + 17511)))
(8 / (8 + 17411))
data$COVID[[1]]
data$COVID[[2]]
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(proportion_matrix)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
proportion_matrix <- matrix(
c((data$COVID[[1]] / (data$COVID[[1]] + data$COVID[[2]])),
(data$COVID[[2]] / (data$COVID[[1]] + data$COVID[[2]])),
(data$No_COVID[[1]] / (data$No_COVID[[1]] + data$No_COVID[[2]])),
(data$No_COVID[[2]] / (data$No_COVID[[1]] + data$No_COVID[[2]]))),
nrow = 2, ncol = 2
)
rownames(proportion_matrix) <- data[, 1]
colnames(proportion_matrix) <- data[1, ]
colnames(data)
colnames(data)[2, 3]
colnames(data)[2:3]
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(data_mosaic)
View(data)
View(data_boxplot)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(proportion_matrix)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(data_boxplot)
View(proportion_matrix)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(proportion_matrix)
View(proportion_matrix)
View(data_boxplot)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(proportion_df)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(proportion_df)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
max(proportion_df$COVID)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
data <- read_csv("data.csv", show_col_types = F)
data <- read.csv("data.csv", show_col_types = F)
data <- read.csv("data.csv")
vaccine <- data %>%
filter(Test == "Vaccine")
knitr::opts_chunk$set(echo = TRUE)
library(boot)
library(tidyverse)
data <- read.csv("data.csv")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(boot)
library(tidyverse)
# Chunk 2
data <- read.csv("data.csv")
vaccine <- data %>%
filter(Test == "Vaccine")
placebo <- data %>%
filter(Test == "Placebo")
prop_vaccine <- vaccine$COVID[1] / vaccine$No_COVID[1]
prop_placebo <- placebo$COVID[1] / placebo$No_COVID[1]
observed_diff <- prop_placebo - prop_vaccine
n_vaccine <- vaccine$COVID + vaccine$No_COVID
n_placebo <- placebo$COVID + placebo$No_COVID
observed_diff <- prop_placebo - prop_vaccine
n_bootstrap <- 10000
bootstrap_diffs <- numeric(n_bootstrap)
set.seed(123)
for (i in 1:n_bootstrap) {
vaccine_sample <- sample(c(0, 1), size = n_vaccine, replace = TRUE, prob = c(1 - prop_vaccine, prop_vaccine))
placebo_sample <- sample(c(0, 1), size = n_placebo, replace = TRUE, prob = c(1 - prop_placebo, prop_placebo))
prop_vaccine_boot <- mean(vaccine_sample)
prop_placebo_boot <- mean(placebo_sample)
bootstrap_diffs[i] <- prop_placebo_boot - prop_vaccine_boot
}
# Calculate overall confidence interval
overall_ci <- quantile(bootstrap_diffs, c(0.025, 0.975))
# Calculate confidence intervals for each bootstrap sample
ci_data <- data.frame(
Iteration = 1:n_bootstrap,
Lower = numeric(n_bootstrap),
Upper = numeric(n_bootstrap)
)
for (i in 1:n_bootstrap) {
sample_diffs <- sample(bootstrap_diffs, n_bootstrap, replace = TRUE)
ci_data$Lower[i] <- quantile(sample_diffs, 0.025)
ci_data$Upper[i] <- quantile(sample_diffs, 0.975)
}
# Subset for plotting (e.g., plot every 500th iteration)
plot_data <- ci_data[seq(1, n_bootstrap, by = 200), ]
# Plot horizontal segmented line graph with overall confidence interval
ggplot(plot_data, aes(y = Iteration)) +
geom_vline(xintercept = observed_diff, linetype = "solid", color = "red") +
geom_segment(aes(yend = Iteration, x = Lower, xend = Upper), color = "blue") +
geom_vline(xintercept = overall_ci[1], linetype = "dashed", color = "red") +
geom_vline(xintercept = overall_ci[2], linetype = "dashed", color = "red") +
labs(title = "Confidence Intervals of Bootstrap Samples",
y = "Iteration",
x = "Confidence Interval") +
scale_x_continuous(limits = c(0.007, 0.011),
breaks = seq(0.007, 0.011, by = 0.001)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center the plot title
axis.text.y = element_text(hjust = 1)) # Angle the y-axis labels for readability
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(data)
View(proportion_df)
View(t(data))
View(t(data[, 2:3]))
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(proportion_df_2)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(transposed_data)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(proportion_df)
proportion_df <- data.frame(
Test = data$Test,
COVID = c((data$COVID[[1]] / (data$COVID[[1]] + data$COVID[[2]])),
(data$COVID[[2]] / (data$COVID[[1]] + data$COVID[[2]]))),
No_COVID = c((data$No_COVID[[1]] / (data$No_COVID[[1]] +
data$No_COVID[[2]])),
(data$No_COVID[[2]] / (data$No_COVID[[1]] +
data$No_COVID[[2]])))
)
View(proportion_df)
rownames(transposed_data)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
t_data
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(transposed_data)
View(proportion_df2)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(proportion_df_2_melted)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/project.R", echo=TRUE)
View(data)
