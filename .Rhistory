library(readr)
data <- read_csv("data.csv")
View(data)
data%>% ggplot(aes(x = Test)) +
geom(bar)
library tidyverse
library(tidyverse)
library(tidyverse)
data %>% ggplot(aes(x = Test)) +
geom(bar)
data %>% ggplot(aes(x = Test)) +
geom_bar
data %>% ggplot(aes(x = Test)) +
geom_bar()
data %>% ggplot(aes(x = COVID)) +
geom_bar()
data %>% ggplot(aes(x = COVID), fill = Test) +
geom_bar()
View(data)
data %>% ggplot(aes(x = Test))
data %>% ggplot(aes(x = Test)) +
geom_bar()
data %>% ggplot(aes(x = Test, y = COVID)) +
geom_bar()
data <- read_csv("data.csv")
data_new <- data.frame(
Group = rep(c("Vaccine", "Placebo"), each = 2),
Status = rep(c("Test", "No_COVID"), 2),
Count = c(8, 17411, 162, 17511)
)
View(data_new)
data <- read_csv("data.csv")
data_new <- data.frame(
Group = rep(c("Vaccine", "Placebo"), each = 2),
Status = rep(c("Test", "No_COVID"), 2),
Count = c(8, 17411, 162, 17511)
)
data_new %>% ggplot(aes(x = Group, y = Count, fill = Status)) +
geom_bar(position = "stack", stat = "identity") +
labs(title = "Stacked Bar Plot of COVID Cases by Group",
x = "Group",
y = "Count",
fill = "Status") +
theme_minimal()
data_long <- pivot_longer(data, cols = c(COVID, No_COVID),
names_to = "Status",
values_to = "Count")
data_long %>% ggplot(aes(fill = Status, y = Count, x = Test)) +
geom_bar(position = "stack", stat = "identity") +
labs(title = "Stacked Bar Plot of COVID cases by Grou",
x = "Group",
y = "Count",
fill = "Status") +
theme_minimal()
View(data_long)
data_long <- pivot_longer(data, cols = c(COVID, No_COVID),
names_to = "Status",
values_to = "Count")
data_long %>% ggplot(aes(fill = Test, y = Count, x = Group)) +
geom_bar(position = "stack", stat = "identity") +
labs(title = "Stacked Bar Plot of COVID cases by Group",
x = "Group",
y = "Count",
fill = "Status") +
theme_minimal()
data_long <- pivot_longer(data, cols = c(COVID, No_COVID),
names_to = "Status",
values_to = "Count")
data_long %>% ggplot(aes(fill = Test, y = Count, x = Status)) +
geom_bar(position = "stack", stat = "identity") +
labs(title = "Stacked Bar Plot of COVID cases by Group",
x = "Group",
y = "Count",
fill = "Status") +
theme_minimal()
View(data)
View(data_long)
View(data)
View(data_long)
data %>% ggplot(aes(x = No_COVID, fill = Test)+
geom_bar()
data %>% ggplot(aes(x = No_COVID, fill = Test)) +
geom_bar()
library(tidyverse)
data %>% ggplot(aes(x = No_COVID, fill = Test)) +
geom_bar()
View(data_new)
data <- read_csv("data.csv")
data <- data.frame(
Group = c("Vaccine", "Placebo"),
COVID = c(8, 162),
No_COVID = c(17411, 17511)
)
# Melt the data frame for ggplot2
library(reshape2)
data_melted <- melt(data, id.vars = "Group")
# Plotting
ggplot(data_melted, aes(x = Group, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Group", y = "Number of Participants",
title = "COVID vs No COVID in Vaccine and Placebo Groups") +
scale_fill_manual(values = c("COVID" = "skyblue", "No_COVID" = "orange"),
name = "Condition") +
theme_minimal()
data <- read_csv("data.csv")
data <- data.frame(
Group = c("Vaccine", "Placebo"),
COVID = c(8, 162),
No_COVID = c(17411, 17511)
)
library(reshape2)
data_melted <- melt(data, id.vars = "Group")
ggplot(data_melted, aes(x = Group, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Group", y = "Number of Participants",
title = "COVID vs No COVID in Vaccine and Placebo Groups") +
data <- read_csv("data.csv")
data <- data.frame(
Group = c("Vaccine", "Placebo"),
COVID = c(8, 162),
No_COVID = c(17411, 17511)
)
# Melt the data frame for ggplot2
library(reshape2)
data_melted <- melt(data, id.vars = "Group")
# Plotting
ggplot(data_melted, aes(x = Group, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Group", y = "Number of Participants",
title = "COVID vs No COVID in Vaccine and Placebo Groups")
library(tidyverse)
library(reshape2)
data <- read_csv("data.csv")
data <- data.frame(
Group = c("Vaccine", "Placebo"),
COVID = c(8, 162),
No_COVID = c(17411, 17511)
)
data_melted <- melt(data, id.vars = "Group")
ggplot(data_melted, aes(x = Group, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Group", y = "Number of Participants",
title = "COVID vs No COVID in Vaccine and Placebo Groups")
View(data_melted)
data <- read_csv("data.csv")
data <- data.frame(
Group = c("Vaccine", "Placebo"),
COVID = c(8, 162),
No_COVID = c(17411, 17511)
)
data_melted <- melt(data, id.vars = "Group")
ggplot(data_melted, aes(x = Group, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Group", y = "Number of Participants",
title = "COVID vs No COVID in Vaccine and Placebo Groups")
View(data)
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Group")
View(data)
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Group, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Group", y = "Number of Participants",
title = "COVID vs No COVID in Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Group, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Test", y = "Number of Participants",
title = "COVID vs No COVID in Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Test", y = "Number of Participants",
title = "COVID vs No COVID in Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
library(tidyverse)
library(reshape2)
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
ylim(20000)
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
ylim(0, 20000)
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
facet_wrap(~ variable, scales = "free_y") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(y = value, fill = Test)) +
geom_bar(stat = "identity") +
facet_wrap(~ variable, scales = "free_y") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
facet_wrap(~ variable, scales = "free_y") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value) +
geom_bar(stat = "identity") +
facet_wrap(~ variable, scales = "free_y") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
facet_wrap(~ variable, scales = "free_y") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
facet_wrap(~ variable) +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
facet_wrap(~ variable, scales = "free_y") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value)) +
geom_bar(stat = "identity") +
facet_wrap(~ variable, scales = "free_y") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(trans = 'log10') +
labs(x = "Test", y = "Number of Participants (log scale)",
title = "COVID Infection for Vaccine and Placebo Groups")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value)) +
geom_bar(stat = "identity") +
facet_wrap(~ variable, scales = "free_y") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
ylim(0, 20000)
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
ylim(0, 100000)
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
ylim(0, 18000)
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
ggplot(data_melted, aes(x = Test, y = value)) +
geom_bar(stat = "identity") +
facet_wrap(~ variable, scales = "free_y") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
data <- read_csv("data.csv")
data_melted <- melt(data, id.vars = "Test")
library(maxLik)
library(maxLik)
install.packages("maxLik")
library(maxLik)
library(tidyverse)
library(maxLik)
library(tidyverse)
loglik <-function(psi, t, n){
return( t*log((1-psi)/(2-psi)) + (n-t)*log(1-((1-psi)/(2-psi))))
}
maxLik(logLik = loglik start = 0.9507,
loglik <-function(psi, t, n){
return( t*log((1-psi)/(2-psi)) + (n-t)*log(1-((1-psi)/(2-psi))))
}
maxLik(logLik = loglik, start = 0.9507,
method = "NR", tol = 1e-4,
t = 8, n = 170)
loglik <- function(psi, T, n) {
return(T * log((1 - psi) / (2 - psi)) + (n - T) * log(1 - ((1 - psi) / (2 - psi))))
}
maxLik(logLik = loglik, start = 0.9507,
method = "NR", tol = 1e-4,
T = 8, n = 170)
loglik <- function(psi, T, n) {
return(log(choose(n,T)) + T * log((1 - psi) / (2 - psi)) + (n - T) * log(1 - ((1 - psi) / (2 - psi))))
}
maxLik(logLik = loglik, start = 0.9507,
method = "NR", tol = 1e-4,
T = 8, n = 170)
loglik <- function(psi, T, n) {
return(log(choose(n,T)) + T * log((1 - psi) / (2 - psi)) + (n - T) * log(1 - ((1 - psi) / (2 - psi))))
}
maxLik(logLik = loglik, start = 0.9507,
method = "NR", tol = 1e-4,
T = 8, n = 170)
loglik <- function(psi, T, n) {
return(log(choose(n,T)) + T * log((1 - psi) /
(2 - psi)) + (n - T) * log(1 - ((1 - psi) / (2 - psi))))
}
maxLik(logLik = loglik, start = 0.9507,
method = "NR", tol = 1e-4,
T = 8, n = 170)
View(data)
View(data_new)
library(maxLik)
library(tidyverse)
View(data_new)
#Use this code chunk to include libraries, and set global options.
knitr::opts_chunk$set(warning = FALSE)
library(tidyverse)
library(maxLik)
library(reshape2)
library(fastR2)
#Use this code chunk to include libraries, and set global options.
knitr::opts_chunk$set(warning = FALSE)
library(tidyverse)
library(maxLik)
library(reshape2)
library(fastR2)
#Use this code chunk to include libraries, and set global options.
knitr::opts_chunk$set(warning = FALSE)
library(tidyverse)
library(maxLik)
library(reshape2)
library(fastR2)
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
geom_text(aes(label = value),
position = position_stack(vjust = 0.5)) +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
geom_text(aes(label = value),
position = position_stack(vjust = 0.5)) +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Vaccine and Placebo Groups")
View(data)
#Use this code chunk to include libraries, and set global options.
knitr::opts_chunk$set(warning = FALSE)
library(tidyverse)
library(maxLik)
library(reshape2)
library(fastR2)
ggplot(data_melted, aes(x = Test, y = value, fill = variable)) +
geom_bar(stat = "identity") +
geom_text(aes(label = value),
position = position_stack(vjust = 0.5)) +
labs(x = "Test", y = "Number of Participants",
title = "COVID Infection for Placebo and Test Groups")
knitr::opts_chunk$set(warning = FALSE)
library(tidyverse)
library(maxLik)
library(reshape2)
library(fastR2)
loglik <- function(psi, T, n){
if (psi > 1 | psi < 0)
return(NA)
else
return(log(choose(n, T)) + (T * log(1 - psi)) - (n * log(2 - psi)))
}
estimation <- maxLik2(loglik = loglik, start = 0.55, method = "NR", tol = 1e-4,
T = 8, n = 170)
print(estimation)
plot(estimation) +
labs(title = "Second order approximation to the Log-Likelihood Function",
x = expression(psi))
W = (2 * 8 * log(1 - (77 / 81))) - (2 * 170 * log(2 - (77 / 81))) -
(2 * 8 * log(1 - 0.95)) + (2 * 170 * log(2 - 0.95))
p_value <- round(pchisq(q = W, df = 1, lower.tail=F), 4)
se <- 1/ (170/(2-0.9506)^2) - (8/(1-.9506)^2)
se <- 1/ (170/(2-0.9506)^2) - (8/(1-.9506)^2)
upper_lim <- 0.9506 + 1.96*sqrt(-1/se)
se <- 1/ (170/(2-0.9506)^2) - (8/(1-.9506)^2)
upper_lim <- 0.9506 + 1.96*sqrt(-1/se)
lower_lim <- 0.9506 - 1.96*sqrt(-1/se)
se <- sqrt (-1/ (170/(2-0.9506)^2) - (8/(1-.9506)^2)))
se <- sqrt (-1/ (170/(2-0.9506)^2) - (8/(1-.9506)^2))
upper_lim <- 0.9506 + 1.96*se
lower_lim <- 0.9506 - 1.96*se
se <- sqrt( -1/ (170/(2-0.9506)^2) - (8/(1-.9506)^2)) )
se <- sqrt( -1/ (170/(2-0.9506)^2) - (8/(1-.9506)^2))
upper_lim <- 0.9506 + 1.96*se
lower_lim <- 0.9506 - 1.96*se
se <- sqrt(-1/((170/(2-0.9506)^2) - (8/(1-0.9506)^2)))
upper_lim <- 0.9506 + 1.96*se
lower_lim <- 0.9506 - 1.96*se
