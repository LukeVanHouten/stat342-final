# Chunk 1: setup
#Use this code chunk to include libraries, and set global options.
knitr::opts_chunk$set(warning = FALSE)
library(tidyverse)
library(maxLik)
library(reshape2)
library(fastR2)
# Chunk 2
loglik <- function(psi, T, n){
if (psi > 1 | psi < 0)
return(NA)
else
return(log(choose(n, T)) + (T * log(1 - psi)) - (n * log(2 - psi)))
}
estimation <- maxLik2(loglik = loglik, start = 0.55, method = "NR", tol = 1e-4,
T = 8, n = 170)
print(estimation)
# Chunk 3
W = (2 * 8 * log(1 - (77 / 81))) - (2 * 170 * log(2 - (77 / 81))) -
(2 * 8 * log(1 - 0.95)) + (2 * 170 * log(2 - 0.95))
p_value <- round(pchisq(q = W, df = 1, lower.tail=F), 4)
# Chunk 1: setup
#Use this code chunk to include libraries, and set global options.
knitr::opts_chunk$set(warning = FALSE)
library(tidyverse)
library(maxLik)
library(reshape2)
library(fastR2)
# Chunk 2
loglik <- function(psi, T, n){
if (psi > 1 | psi < 0)
return(NA)
else
return(log(choose(n, T)) + (T * log(1 - psi)) - (n * log(2 - psi)))
}
estimation <- maxLik2(loglik = loglik, start = 0.55, method = "NR", tol = 1e-4,
T = 8, n = 170)
print(estimation)
# Chunk 3
W = (2 * 8 * log(1 - (77 / 81))) - (2 * 170 * log(2 - (77 / 81))) -
(2 * 8 * log(1 - 0.95)) + (2 * 170 * log(2 - 0.95))
p_value <- round(pchisq(q = W, df = 1, lower.tail=F), 4)
data <- read.csv("data.csv")
vaccine <- data %>%
filter(Test == "Vaccine")
placebo <- data %>%
filter(Test == "Placebo")
n_vaccine <- vaccine$COVID + vaccine$No_COVID
n_placebo <- placebo$COVID + placebo$No_COVID
prop_vaccine <- vaccine$COVID[1] / n_vaccine
prop_placebo <- placebo$COVID[1] / n_placebo
observed_pi <- prop_vaccine/(prop_vaccine + prop_placebo)
observed_psi <- (1 - 2*observed_pi)/(1 - observed_pi)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
pivot_data <- data %>%
pivot_longer(cols = c(COVID, No_COVID), names_to = "Tests", values_to = "Count")
summary <- pivot_data %>%
group_by(Test) %>%
summarise(min = min(Count), lower = quantile(Count, 0.25),
median = median(Count), upper = quantile(Count, 0.75),
max = max(Count))
ggplot(pivot_data, aes(x = Test, y = Count, fill = Test)) +
geom_boxplot() +
geom_text(data = summary, aes(x = Test, y = median, label = paste("Median:", median)),
vjust = -0.5, color = "black") +
geom_text(data = summary, aes(x = Test, y = lower, label = paste("Q1:", lower)),
vjust = 1.5, hjust = -0.3, color = "black") +
geom_text(data = summary, aes(x = Test, y = upper, label = paste("Q3:", upper)),
vjust = -1, hjust = -0.3, color = "black") +
geom_text(data = summary, aes(x = Test, y = min, label = paste("Min:", min)),
vjust = 1.5, color = "black") +
geom_text(data = summary, aes(x = Test, y = max, label = paste("Max:", max)),
vjust = -1.5, color = "black") +
labs(title = "Positive and Negative COVID Test Counts by Test Group",
x = "Test Group", y = "Number of Tests")
source("C:/Users/lukev/Desktop/Luke Files/School/2023-2024/Spring/STAT 342/stat342-final/Other Visualizations.R", echo=TRUE)
pivot_data <- data %>%
pivot_longer(cols = c(COVID, No_COVID), names_to = "Tests", values_to = "Count")
summary <- pivot_data %>%
group_by(Test) %>%
summarise(min = min(Count), lower = quantile(Count, 0.25),
median = median(Count), upper = quantile(Count, 0.75),
max = max(Count))
ggplot(pivot_data, aes(x = Test, y = Count, fill = Test)) +
geom_boxplot() +
geom_text(data = summary, aes(x = Test, y = median,
label = paste("Median:", median)),
vjust = -0.5) +
geom_text(data = summary, aes(x = Test, y = lower,
label = paste("Q1:", lower)),
vjust = 1.5, hjust = -0.3) +
geom_text(data = summary, aes(x = Test, y = upper,
label = paste("Q3:", upper)),
vjust = -1, hjust = -0.3) +
geom_text(data = summary, aes(x = Test, y = min,
label = paste("Min:", min)),
vjust = 1.3) +
geom_text(data = summary, aes(x = Test, y = max,
label = paste("Max:", max)),
vjust = -1.1) +
labs(title = "Positive and Negative COVID Test Counts by Test Group",
x = "Test Group", y = "Number of Tests")
pivot_data <- data %>%
pivot_longer(cols = c(COVID, No_COVID), names_to = "Tests", values_to = "Count")
summary <- pivot_data %>%
group_by(Test) %>%
summarise(min = min(Count), lower = quantile(Count, 0.25),
median = median(Count), upper = quantile(Count, 0.75),
max = max(Count))
ggplot(pivot_data, aes(x = Test, y = Count, fill = Test)) +
geom_boxplot() +
geom_text(data = summary, aes(x = Test, y = median,
label = paste("Median:", median)),
vjust = -0.5) +
geom_text(data = summary, aes(x = Test, y = lower,
label = paste("Q1:", lower)),
vjust = 1.5, hjust = -0.3) +
geom_text(data = summary, aes(x = Test, y = upper,
label = paste("Q3:", upper)),
vjust = -1, hjust = -0.3) +
geom_text(data = summary, aes(x = Test, y = min,
label = paste("Min:", min)),
vjust = 1.3) +
geom_text(data = summary, aes(x = Test, y = max,
label = paste("Max:", max)),
vjust = -1) +
labs(title = "Positive and Negative COVID Test Counts by Test Group",
x = "Test Group", y = "Number of Tests")
